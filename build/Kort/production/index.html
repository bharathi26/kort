<!DOCTYPE HTML>
<html manifest="cache.appcache" lang="de-CH">
<head>
    <meta charset="UTF-8">
    <title>Kort</title>
    <link rel="icon" href="./resources/images/kort-favicon.ico" type="image/png" />
    <script type="text/javascript">
        // create namespace
        var KortStartscreen = {};
        KortStartscreen.supportedLanguages = ['en', 'de', 'it', 'fr', 'sl', 'hr', 'cs', 'nl', 'gl', 'pt', 'ro', 'ja', 'ca', 'es'];
        KortStartscreen.supportedBrowsers = ['WebKit'];
        KortStartscreen.defaultLanguage = 'en';
        
        KortStartscreen.getLanguage = function() {
            var currentLang = (navigator.language || navigator.browserLanguage || navigator.userLanguage || KortStartscreen.defaultLanguage),
                supportedLanguages = KortStartscreen.supportedLanguages,
                langLen = supportedLanguages.length,
                i;

            currentLang = currentLang.substring(0, 2).toLowerCase();
            for(i = 0; i < langLen; i++) {
                if (supportedLanguages[i] === currentLang) {
                    return currentLang;
                }
            }
            return KortStartscreen.defaultLanguage;
        }
        
        KortStartscreen.isBrowserSupported = function() {
            var supportedBrowsers = KortStartscreen.supportedBrowsers,
                supportedBrowsersLen = supportedBrowsers.length,
                i;

            for(i = 0; i < supportedBrowsersLen; i++) {
                if(Ext.browser.is(supportedBrowsers[i])) {
                    return true;
                }
            }
            return false;
        }

        KortStartscreen.lang = KortStartscreen.getLanguage();
        KortStartscreen.messages = {
            de: {
                'startscreen.loadingtext': 'Kort wird geladen. Gleich gehts los...',
                'startscreen.browsererror': 'Dein Browser wird leider nicht unterstützt. Kort ist optimiert für den Betrieb auf mobilen Geräten. Versuch es doch damit.'
            },
            en: {
                'startscreen.loadingtext': 'Kort is loading. Get ready...',
                'startscreen.browsererror': 'Your browser is not supported yet. Try it on your mobile phone.'
            },
            it: {
                'startscreen.loadingtext': 'Kort si sta caricando. Tieniti pronto...',
                'startscreen.browsererror': 'Questo browser non è supportato al momento. Prova dal tuo smartphone.'
            },
            fr: {
                'startscreen.loadingtext': 'Chargement de Kort. Tenez vous prêts...',
                'startscreen.browsererror': "Votre navigateur n'est pas encore supporté. Veuillez essayer sur votre téléphone mobile."
            },
            sl: {
                'startscreen.loadingtext': 'Kort se nalaga. Pripavi se...',
                'startscreen.browsererror': 'Tvoj brskalnik še ne podpira uporabe. Poskusi s tvojim mobilnim telefonom.'
            },
            hr: {
                'startscreen.loadingtext': 'Kort se učitava. Spremite se...',
                'startscreen.browsererror': 'Your browser is not supported yet. Try it on your mobile phone.'
            },
            cs: {
                'startscreen.loadingtext': 'se nahrává. Připravte se...',
                'startscreen.browsererror': 'Your browser is not supported yet. Try it on your mobile phone.'
            },
            nl: {
                'startscreen.loadingtext': 'Is aan het inladen. Bereid je voor...',
                'startscreen.browsererror': 'Je browser wordt nog niet ondersteund. Probeer het op je smartphone.'
            },
            gl: {
                'startscreen.loadingtext': 'Kort está a cargar. Prepárate...',
                'startscreen.browsererror': 'O teu navegador non está aínda soportado. Téntao co teu teléfono móbil.'
            },
            pt: {
                'startscreen.loadingtext': 'Kort está a carregar. Prepare-se...',
                'startscreen.browsererror': 'Your browser is not supported yet. Try it on your mobile phone.'
            },
            ro: {
                'startscreen.loadingtext': 'Kort se încarcă. Pregătiți-vă...',
                'startscreen.browsererror': 'Navigatorul dumneavoastră web nu este încă suportat. Încercați-l pe telefonul mobil.'
            },
            ja: {
                'startscreen.loadingtext': 'Kortを読み込み中。Get ready...',
                'startscreen.browsererror': 'ご利用中のブラウザーにはまだ対応していません。携帯電話でお試しください。'
            },
            ca: {
                'startscreen.loadingtext': "Kort està carregant. Prepara't...",
                'startscreen.browsererror': 'El teu navegador encara no està suportat. Prova amb el teu telèfon mòbil.'
            },
            es: {
                'startscreen.loadingtext': 'Kort está cargando. Preparate...',
                'startscreen.browsererror': 'Tu navegador aún no está soportado. Prueba en tu teléfono móvil.'
            }
        }
        
        KortStartscreen.init = function() {
            KortStartscreen.setLanguage();
            KortStartscreen.detectBrowser();
        }
        
        KortStartscreen.getMessage = function(key) {
            return KortStartscreen.messages[KortStartscreen.lang][key];
        }
        
        KortStartscreen.setLanguage = function() {
            if(document.getElementById('startscreen-loading-text')) {
                document.getElementById('startscreen-loading-text').innerHTML = KortStartscreen.getMessage('startscreen.loadingtext');
            }
        }
        KortStartscreen.detectBrowser = function() {
            if(!KortStartscreen.isBrowserSupported()) {
                document.getElementById('startscreen-kort-logo').innerHTML = '<img src="./resources/images/kort-logo.png" />';
                document.getElementById('appStartscreen').style.backgroundColor = '#eee';
                document.getElementById('appStartscreen').style.color = '#000';
                document.getElementById('startscreen-loading-content').innerHTML =
                    '<div class="sadsmiley">:(</div>' +
                    '<div class="browser-error">' +
                        KortStartscreen.getMessage('startscreen.browsererror') +
                    '</div>';
            }
        }
    </script>
    <style type="text/css">
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: "Helvetica Neue", HelveticaNeue, "Helvetica-Neue", Helvetica, "BBAlpha Sans", sans-serif;
        }
        #appStartscreen {
            font-size: 18px !important;
            height: 100%;
            background-color: #395971;
            color: #fff;
            padding: 1.5em 0.5em 0.5em 0.5em;
            text-align: center;
        }
        #appStartscreen #startscreen-kort-logo img {
            width: 150px;
            height: 150px;
        }
        #appStartscreen #startscreen-loading-content #startscreen-loading-text,
        #appStartscreen #startscreen-loading-content .browser-error {
            font-size: 0.9em;
            margin: 1.5em 0.8em 0 0.8em;
        }
        #appStartscreen #startscreen-loading-content #startscreen-loading-text {
            text-transform: uppercase;
        }
        #appStartscreen #startscreen-loading-content .loading-spinner {
            margin-top: 1em;
        }
        #appStartscreen #startscreen-loading-content .sadsmiley {
            font-size: 4em;
        }
    </style>

    <!-- The line below must be kept intact for Sencha Command to build your application -->
    <script type="text/javascript">(function(i){function s(a){function b(a,j){var c=a.length,b,g;for(b=0;b<c;b++){g=a[b];var e=a,K=b,d=void 0;"string"==typeof g&&(g={path:g});g.shared?(g.version=g.shared,d=g.shared+g.path):(z.href=g.path,d=z.href);g.uri=d;g.key=h+"-"+d;f[d]=g;e[K]=g;g.type=j;g.index=b;g.collection=a;g.ready=!1;g.evaluated=!1}return a}var c;"string"==typeof a?(c=a,a=A(c)):c=JSON.stringify(a);var h=a.id,e=h+"-"+B+o,f={};this.key=e;this.css=b(a.css,"css");this.js=b(a.js,"js");this.assets=this.css.concat(this.js);this.getAsset=
function(a){return f[a]};this.store=function(){t(e,c)}}function C(a,b){k.write('<meta name="'+a+'" content="'+b+'">')}function p(a,b,c){var h=new XMLHttpRequest,c=c||D,a=a+(-1==a.indexOf("?")?"?":"&")+Date.now();try{h.open("GET",a,!0),h.onreadystatechange=function(){if(4==h.readyState){var a=h.status,d=h.responseText;200<=a&&300>a||304==a||0==a&&0<d.length?b(d):c()}},h.send(null)}catch(d){c()}}function L(a,b){var c=k.createElement("iframe");m.push({iframe:c,callback:b});c.src=a+".html";c.style.cssText=
"width:0;height:0;border:0;position:absolute;z-index:-999;visibility:hidden";k.body.appendChild(c)}function E(a,b,c){var d=!!a.shared;if(a.remote)b("");else{if(!d)var e=b,f=a.version,l,b=function(j){l=j.substring(0,f.length+4);l!=="/*"+f+"*/"?confirm("Requested: '"+a.uri+"' with checksum: "+f+" but received: "+l.substring(2,f.length)+"instead. Attempt to refresh the application?")&&M():e(j)};(d?L:p)(a.uri,b,c)}}function F(a){var b=a.data,a=a.source.window,c,d,e,f;c=0;for(d=m.length;c<d;c++)if(e=m[c],
f=e.iframe,f.contentWindow===a){e.callback(b);k.body.removeChild(f);m.splice(c,1);break}}function G(a){"undefined"!=typeof console&&(console.error||console.log).call(console,a)}function t(a,b){try{n.setItem(a,b)}catch(c){if(c.code==c.QUOTA_EXCEEDED_ERR&&q){var d=q.assets.map(function(a){return a.key}),e=0,f=n.length,l=!1,j;for(d.push(q.key);e<=f-1;)j=n.key(e),-1==d.indexOf(j)?(n.removeItem(j),l=!0,f--):e++;l&&t(a,b)}}}function u(a){try{return n.getItem(a)}catch(d){return null}}function M(){H||(H=
!0,p(o,function(a){(new s(a)).store();i.location.reload()}))}function v(a){function b(a,d){var b=a.collection,g=a.index,f=b.length,e;a.ready=!0;a.content=d;for(e=g-1;0<=e;e--)if(a=b[e],!a.ready||!a.evaluated)return;for(e=g;e<f;e++)if(a=b[e],a.ready)a.evaluated||c(a);else break}function c(a){a.evaluated=!0;if("js"==a.type)try{eval(a.content)}catch(b){G("Error evaluating "+a.uri+" with message: "+b)}else{var d=k.createElement("style"),c;d.type="text/css";d.textContent=a.content;"id"in a&&(d.id=a.id);
"disabled"in a&&(d.disabled=a.disabled);c=document.createElement("base");c.href=a.path.replace(/\/[^\/]*$/,"/");w.appendChild(c);w.appendChild(d);w.removeChild(c)}delete a.content;0==--f&&h()}function h(){function b(){k&&c()}function c(){var a=r.onUpdated||D;if("onSetup"in r)r.onSetup(a);else a()}function e(){l.store();h.forEach(function(a){t(a.key,a.content)});c()}function g(a,b){a.content=b;0==--m&&(d.status==d.IDLE?e():i=e)}function f(){I("online",f,!1);p(o,function(c){q=l=new s(c);var e;l.assets.forEach(function(b){e=
a.getAsset(b.uri);(!e||b.version!==e.version)&&h.push(b)});m=h.length;0==m?d.status==d.IDLE?b():i=b:h.forEach(function(b){function d(){E(b,function(a){g(b,a)})}var c=a.getAsset(b.uri),e=b.path,f=b.update;!c||!f||null===u(b.key)||"delta"!=f?d():p("deltas/"+e+"/"+c.version+".json",function(a){try{var d=b,c;var e=u(b.key),f=A(a),a=[],h,j,i;if(0===f.length)c=e;else{j=0;for(i=f.length;j<i;j++)h=f[j],"number"===typeof h?a.push(e.substring(h,h+f[++j])):a.push(h);c=a.join("")}g(d,c)}catch(k){G("Malformed delta content received for "+
b.uri)}},d)})})}var h=[],k=!1,i=function(){},n=function(){d.swapCache();k=!0;i()},m;I("message",F,!1);if(d.status==d.UPDATEREADY)n();else if(d.status==d.CHECKING||d.status==d.DOWNLOADING)d.onupdateready=n,d.onnoupdate=d.onobsolete=function(){i()};!1!==navigator.onLine?f():x("online",f,!1)}var e=a.assets,f=e.length,l;q=a;x("message",F,!1);0==f?h():e.forEach(function(a){var c=u(a.key);null===c?E(a,function(c){a.remote||t(a.key,c);b(a,c)},function(){b(a,"")}):b(a,c)})}function J(a){null!==k.readyState.match(/interactive|complete|loaded/)?
v(a):x("DOMContentLoaded",function(){navigator.standalone?setTimeout(function(){setTimeout(function(){v(a)},1)},1):v(a)},!1)}var D=function(){},m=[],k=i.document,w=k.head,x=i.addEventListener,I=i.removeEventListener,n=i.localStorage,d=i.applicationCache,A=JSON.parse,z=k.createElement("a"),y=k.location,B=y.origin+y.pathname+y.search,o="app.json",H=!1,q;if("undefined"===typeof r)var r=i.Ext={};r.blink=function(a){var b=u(a.id+"-"+B+o);C("viewport","width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no");
C("apple-touch-fullscreen","yes");b?(a=new s(b),J(a)):p(o,function(b){a=new s(b);a.store();J(a)})}})(this);;Ext.blink({"id":"d6069029-dcbb-4cf2-b20b-cefd12012a6c"})</script>

    <!-- Allow webapp to run in fullscreen mode when added to homescreen in mobile safari -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
</head>
<body onload="KortStartscreen.init()">
    <div id="appStartscreen">
        <div id="startscreen-kort-logo">
            <img src="./resources/images/kort-logo_white.png" />
        </div>
        <div id="startscreen-loading-content">
            <p id="startscreen-loading-text">Kort is loading. Get ready...</p>
            <div class="loading-spinner"><img src="./resources/images/ajax-loader.gif" /></div>
        </div>
    </div>
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-37644286-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
  </script>
</body>
</html>